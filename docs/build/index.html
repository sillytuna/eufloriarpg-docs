<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Eufloria RPG Scripting Guide</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

      <script>
        $(function() {
          setupLanguages(["lua"]);
        });
      </script>
  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="lua">Lua</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='http://www.eufloria-game.com'>Eufloria home</a></li>
            <li><a href='http://www.euflorium.com'>Eufloria forum</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="scripting">Scripting</h1>

<h2 id="introduction">Introduction</h2>

<p>Scripting is implemented using the <a href="http://www.lua.org/manual/5.1/">Lua</a> scripting language.</p>

<p>As well as Lua&rsquo;s <a href="http://www.lua.org/manual/5.1/manual.html#5">standard libries</a>,many additional functions and classes included to allow significant customisation of the game.</p>

<p>It&rsquo;s also possible to access many of <a href="https://goo.gl/wHKMaJ">Mono&rsquo;s standard libraries</a> and <a href="http://docs.unity3d.com/ScriptReference/">Unity&rsquo;s libraries</a>.</p>

<aside class="success">
Lua is integrated with uLua/LuaInterface, an implementation of Lua 5.1.4.
</aside>

<aside class="warning">
Unity 5 will require another Lua plug-in, curently planned to be MoonSharp.
This has a few difference from regular Lua.
</aside>

<h2 id="data-types">Data types</h2>
<pre class="highlight lua"><code><span class="kd">local</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">1</span>
<span class="kd">local</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">25</span><span class="p">.</span><span class="mi">0</span>
<span class="kd">local</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">false</span>
<span class="kd">local</span> <span class="n">value</span> <span class="o">=</span> <span class="s2">"Hello world"</span>
</code></pre>

<p>Lua and C# data types are converted as best as possible. Lua numbers convert to ints or floats, and so on.
C# classes objects are also accessible from Lua and described later.</p>

<aside class="blue">
Take care to precede Lua variable definitions with local unless you really want them to be globally accessible!
</aside>

<h2 id="debugging">Debugging</h2>
<pre class="highlight lua"><code><span class="nb">print</span><span class="p">(</span><span class="s2">"Hello World"</span><span class="p">)</span>
</code></pre>

<p>Use Lua&rsquo;s print functionality to log to the console. <a href="http://www.lua.org/pil/2.4.html">See examples</a>.</p>

<h2 id="accessing-c-classes-and-structs">Accessing C# Classes and Structs</h2>

<blockquote>
<p>Import a class from the game.</p>
</blockquote>
<pre class="highlight lua"><code><span class="n">Action</span> <span class="o">=</span> <span class="n">luanet</span><span class="p">.</span><span class="n">import_type</span><span class="p">(</span><span class="s2">"Action"</span><span class="p">)</span>
</code></pre>

<blockquote>
<p>Import a class from the standard libraries.</p>
</blockquote>
<pre class="highlight lua"><code><span class="n">List</span> <span class="o">=</span> <span class="n">luanet</span><span class="p">.</span><span class="n">import_type</span><span class="p">(</span><span class="s2">"System.Collections.Generic.List"</span><span class="p">)</span>
</code></pre>

<blockquote>
<p>Import a class from UnityEngine.</p>
</blockquote>
<pre class="highlight lua"><code><span class="n">Application</span> <span class="o">=</span> <span class="n">luanet</span><span class="p">.</span><span class="n">import_type</span><span class="p">(</span><span class="s2">"UnityEngine.Application"</span><span class="p">)</span>
</code></pre>

<p>Several C# classes and structs are exposed to Lua and can be used directly by using their name.</p>

<p><code class="prettyprint">&lt;luaclassname&gt; = luanet.import_type(&quot;[&lt;namespace&gt;.]&lt;classname&gt;)</code></p>

<p><code class="prettyprint">&lt;luastructname&gt; = luanet.import_type(&quot;[&lt;namespace&gt;.]&lt;structname&gt;)</code></p>

<blockquote>
<p>Load a custom assembly.</p>
</blockquote>
<pre class="highlight lua"><code><span class="n">luanet</span><span class="p">.</span><span class="n">load_assembly</span><span class="p">(</span><span class="s2">"CustomAssembly"</span><span class="p">)</span>
</code></pre>

<p>Where a class is not accessible from Lua, it can be imported with luanet&rsquo;s load_assembly command. If the class is held in a different assembly,
that must be referenced first, and loaded if not already loaded</p>

<aside class="warning">
Future versions of the game will not allow custom class or assembly imports for security reasons.
</aside>

<h2 id="instantiate-a-c-object">Instantiate a C# Object</h2>

<blockquote>
<p>Instantiate a struct then change it by using a new struct.</p>
</blockquote>
<pre class="highlight lua"><code><span class="kd">local</span> <span class="n">position</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="p">)</span>
<span class="n">position</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="p">)</span>
</code></pre>

<p>Although it&rsquo;s easy to instantiate a C# object, it incures a significant overhead. It should be done as rarely as possible.
Several functions have been provided specifically to help avoid Vector2 and Color structures being required from Lua.</p>

<p>Instantiate an object as follows:</p>

<p><code class="prettyprint">value = new &lt;class&gt;(...)</code></p>

<p><code class="prettyprint">value = new &lt;struct&gt;(...)</code></p>

<aside class="warning">
Structs cannot have their fields set independently, so they must always be set with a new struct.
This has a significant overhead and should be avoided where possible.
</aside>

<h2 id="accessing-c-properties">Accessing C# Properties</h2>

<blockquote>
<p>Access the name property of an entity.</p>
</blockquote>
<pre class="highlight lua"><code><span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="n">entity</span><span class="p">.</span><span class="n">name</span>
</code></pre>

<p>Accessing object properties is done using Lua table accessors, so can use simple dot notation.</p>

<p><code class="prettyprint">value = &lt;object&gt;.&lt;property&gt;</code></p>

<p>If a property is used more than once, it should be cached in a local variable.</p>

<h2 id="accessing-c-methods">Accessing C# Methods</h2>

<blockquote>
<p>Access an instance&rsquo;s function.</p>
</blockquote>
<pre class="highlight lua"><code><span class="kd">local</span> <span class="n">isOnScreen</span> <span class="o">=</span> <span class="n">entity</span><span class="p">.</span><span class="n">IsOnScreen</span><span class="p">()</span>
</code></pre>

<p>Accessing an instance&rsquo;s functions has a different notation from properties; a colon must be used.</p>

<p><code class="prettyprint">value = &lt;instance&gt;:&lt;function&gt;(...)</code></p>

<blockquote>
<p>Access a static class function.</p>
</blockquote>
<pre class="highlight lua"><code><span class="kd">local</span> <span class="n">isOnScreen</span> <span class="o">=</span> <span class="n">Level</span><span class="p">.</span><span class="n">Reset</span><span class="p">()</span>
</code></pre>

<p>However, accessing a static class function must use a dot, just like properties.</p>

<p><code class="prettyprint">value = &lt;class&gt;:&lt;function&gt;(...)</code></p>

<aside class="notice">
Properties start with a lowercase letter, functions start with a capital letter.
</aside>

<h3 id="pass-by-reference">Pass by Reference</h3>

<blockquote>
<p>Pass by &lsquo;ref&rsquo; reference</p>
</blockquote>
<pre class="highlight lua"><code><span class="c1">-- C# function is: public void TryGet(string key, ref Setting setting)</span>
<span class="kd">local</span> <span class="n">setting</span> <span class="o">=</span> <span class="n">null</span>
<span class="n">setting</span> <span class="o">=</span> <span class="n">App</span><span class="p">.</span><span class="n">settingManager</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="s2">"Player.acceleration"</span><span class="p">,</span> <span class="n">setting</span><span class="p">)</span>
</code></pre>

<blockquote>
<p>Pass by &#39;out&rsquo; reference</p>
</blockquote>
<pre class="highlight lua"><code><span class="c1">-- C# function is: public bool TryGet(string key, out Setting setting)</span>
<span class="kd">local</span> <span class="n">result</span><span class="p">,</span> <span class="n">setting</span> <span class="o">=</span> <span class="n">TryGet</span><span class="p">(</span><span class="s2">"Player.speed"</span><span class="p">)</span>
</code></pre>

<p>C# allows arguments to be passed by reference.</p>

<p>Where an argument is specified as <strong>ref</strong>, it means it must be initialised before being passed in and Lua will return an updated value in the return values.</p>

<p>Where an argument is specified as <strong>out</strong>, it should not be passed at all but is treated as an extra return value.</p>

<p><code class="prettyprint">value1, value2 = function(...)</code></p>

<aside class="notice">
Lua allows multiple return values by separating them with a comma.
</aside>

<h2 id="accessing-c-enums">Accessing C# Enums</h2>

<blockquote>
<p>Use an enum.</p>
</blockquote>
<pre class="highlight lua"><code><span class="kd">local</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">ArtifactDef</span><span class="p">.</span><span class="n">Types</span><span class="p">.</span><span class="n">Shield</span>
</code></pre>

<p>Enums are referenced using dot notation:</p>

<p><code class="prettyprint">value = [&lt;Class&gt;.]&lt;Enum&gt;.&lt;Value&gt;</code></p>

<blockquote>
<p>Import new enums.</p>
</blockquote>
<pre class="highlight lua"><code><span class="n">ArtifactDef_Types</span> <span class="o">=</span> <span class="n">luanet</span><span class="p">.</span><span class="n">import_type</span><span class="p">(</span><span class="s2">"ArtifactDef+Types"</span><span class="p">)</span>
<span class="n">RuntimePlatform</span> <span class="o">=</span> <span class="n">luanet</span><span class="p">.</span><span class="n">import_type</span><span class="p">(</span><span class="s2">"UnityEngine.RuntimePlatform"</span><span class="p">)</span>
</code></pre>

<p>If an enum isn&rsquo;t defined in lua, import it with:</p>

<p><code class="prettyprint">&lt;luaenumname&gt; = luanet.import_type(&quot;[&lt;namespace&gt;.][&lt;class&gt;+]&lt;enumname&gt;)</code></p>

<aside class="notice">
The module is followed by &rsquo;.&rsquo; but the class is followed by &rsquo;+&rsquo;.
</aside>

<blockquote>
<p>StringToEnum example.</p>
</blockquote>
<pre class="highlight lua"><code><span class="kd">local</span> <span class="n">artifactType</span> <span class="o">=</span> <span class="s2">"Shield"</span>
<span class="kd">local</span> <span class="n">value</span> <span class="o">=</span> <span class="n">StringToEnum</span><span class="p">(</span><span class="s2">"ArtifaceDef+Types"</span><span class="p">,</span> <span class="n">artifactType</span><span class="p">)</span>
</code></pre>

<p>Where an enum has to come from a string, such as in a config or an external file, use StringToEnum in <a href="#additional-utility-functions">Additional Functions</a>.</p>

<p><code class="prettyprint">StringToEnum(&quot;[&lt;class&gt;+]&lt;type&gt;&quot;, &lt;string&gt;)</code></p>

<blockquote>
<p>StringToEnum example.</p>
</blockquote>
<pre class="highlight lua"><code><span class="kd">local</span> <span class="n">path</span> <span class="o">=</span> <span class="s2">"PlayerManager.Paths.None"</span>
<span class="kd">local</span> <span class="n">pathAsString</span> <span class="o">=</span> <span class="n">StringToEnum</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</code></pre>

<p>StringToEnum does the opposite.</p>

<p><code class="prettyprint">StringToEnum(&lt;value&gt;)</code></p>

<h2 id="manager-classes">Manager Classes</h2>

<blockquote>
<p>Access an object manager.</p>
</blockquote>
<pre class="highlight lua"><code><span class="kd">local</span> <span class="n">terraformEnergy</span> <span class="o">=</span> <span class="n">App</span><span class="p">.</span><span class="n">terraformEnergyManager</span><span class="p">.</span><span class="n">AddEnergy</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</code></pre>

<p>Most objects in the game are handled by associated managers, such as the MobManager for objects, or the ExplosionManager for explosions. Managers are instances rather than static classes, and are accessed through the App static class as follows:</p>

<p><code class="prettyprint">App.&lt;managerName&gt;:&lt;function&gt;(...)</code></p>

<aside class="notice">
Manager instances always start with a lowercase letter, as with all properties.
</aside>

<h2 id="additional-utility-functions">Additional Utility Functions</h2>

<h3 id="stringtoenum">StringToEnum</h3>

<blockquote>
<p>StringToEnum example.</p>
</blockquote>
<pre class="highlight lua"><code><span class="kd">local</span> <span class="n">artifactType</span> <span class="o">=</span> <span class="s2">"Shield"</span>
<span class="kd">local</span> <span class="n">value</span> <span class="o">=</span> <span class="n">StringToEnum</span><span class="p">(</span><span class="s2">"ArtifaceDef+Types"</span><span class="p">,</span> <span class="n">artifactType</span><span class="p">)</span>
</code></pre>

<p>Where an enum has to come from a string, such as in a config or an external file, use StringToEnum.</p>

<p><code class="prettyprint">StringToEnum(&quot;[&lt;class&gt;+]&lt;type&gt;&quot;, &lt;string&gt;)</code></p>

<h3 id="math-randomf-f">math.randomf(f)</h3>

<blockquote>
<p>Get a random int between 0 and 3 (exclusive) using lua&rsquo;s internal function.</p>
</blockquote>
<pre class="highlight lua"><code><span class="kd">local</span> <span class="n">value</span> <span class="o">=</span> <span class="nb">math.random</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</code></pre>

<blockquote>
<p>Get a random float between 0 and 10 (inclusive) using math.randomf.</p>
</blockquote>
<pre class="highlight lua"><code><span class="kd">local</span> <span class="n">value</span> <span class="o">=</span> <span class="n">math</span><span class="p">.</span><span class="n">randomf</span><span class="p">(</span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span>
</code></pre>

<p>Supplements Lua&rsquo;s math.random functions with a method to get a float between two values, inclusive.</p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>f</td>
<td>float</td>
<td>Maximum number to return</td>
</tr>
</tbody></table>

<p><strong>Returns:</strong>
Random value between 0 and f inclusive</p>

<h2 id="supported-classes">Supported Classes</h2>

<table><thead>
<tr>
<th>Class</th>
<th>Namespace</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>List</td>
<td>System</td>
<td>class&lt;generic&gt;</td>
</tr>
<tr>
<td>Dictionary</td>
<td>System</td>
<td>class&lt;generic&gt;</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Application</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>AudioClip</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>AudioListener</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>Camera</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>Color</td>
<td>UnityEngine</td>
<td><strong>struct</strong></td>
</tr>
<tr>
<td>Component</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>Debug</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>Display</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>GameObject</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>Graphics</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>HandHeld</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>Input</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>Mathf</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>Matrix4x4</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>Microphone</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>MonoBehaviour</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>QualitySettings</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>Quaternion</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>Screen</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>Social</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>SystemInfo</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>Texture2D</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>Time</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>Touch</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>Transform</td>
<td>UnityEngine</td>
<td>class</td>
</tr>
<tr>
<td>Vector2</td>
<td>UnityEngine</td>
<td><strong>struct</strong></td>
</tr>
<tr>
<td>Vector3</td>
<td>UnityEngine</td>
<td><strong>struct</strong></td>
</tr>
<tr>
<td>Vector4</td>
<td>UnityEngine</td>
<td><strong>struct</strong></td>
</tr>
<tr>
<td>ReInput</td>
<td>Rewired</td>
<td>class</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ScriptManager</td>
<td>Tuna</td>
<td>class</td>
</tr>
<tr>
<td>SettingManager</td>
<td>Tuna</td>
<td>class</td>
</tr>
<tr>
<td>Setting</td>
<td>Tuna</td>
<td>class</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Action</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>ActionManager</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>Artifact</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>ArtifactDef</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>ArtifactManager</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>Attributes</td>
<td></td>
<td><strong>struct</strong></td>
</tr>
<tr>
<td>Colony</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>DataCan</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>DistanceField</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>DistanceFieldCollisionInfo</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>DistanceFieldAvoidanceInfo</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>Door</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>DoorDef</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>DoorManager</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>Drawing</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>Entity_Overlay</td>
<td>(Entity)</td>
<td>class</td>
</tr>
<tr>
<td>Equipment</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>Explosive</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>Flora</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>FloraDef</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>FloraManager</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>GrassDef</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>GrassManager</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>Key</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>LaserMine</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>Level</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>LevelManager</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>MapEffectManager</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>Overlay</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>Pickup</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>PickupDef</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>PickupManager</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>PlayerManager</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>PlayerShip</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>RadarTarget</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>RadarTargetManager</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>Seedling</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>SoloShip</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>SoundEvent</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>SpriteInstance</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>SpriteDef</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>SpriteManager</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>Team</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>Vehicle</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>Turret</td>
<td></td>
<td>class</td>
</tr>
<tr>
<td>Vortex</td>
<td></td>
<td>class</td>
</tr>
</tbody></table>

<h2 id="supported-enums">Supported Enums</h2>

<h3 id="difficultymodes">DifficultyModes</h3>

<ul>
<li>Casual</li>
<li>Normal</li>
<li>PermaDeath</li>
</ul>

<h3 id="playerpaths">PlayerPaths</h3>

<ul>
<li>Balanced</li>
<li>MostlyStrength</li>
<li>MostlySpeed</li>
<li>MostlyEnergy</li>
<li>FavourStrengthSpeed</li>
<li>FavourStrengthEnergy</li>
<li>FavourSpeedEnergy</li>
</ul>

<h3 id="equipment-states">Equipment States</h3>

<ul>
<li>Uninitialised</li>
<li>Free</li>
<li>Captured</li>
<li>Collecting</li>
<li>Collected</li>
<li>Equipped</li>
<li>Activated</li>
</ul>

<h3 id="inventorycategories">InventoryCategories</h3>

<ul>
<li>Artifact</li>
<li>Consumable</li>
<li>Accessory</li>
<li>Key</li>
</ul>

<h3 id="pickuptypes">PickupTypes</h3>

<ul>
<li>Health</li>
<li>Invulnerability</li>
<li>Invisibility</li>
<li>Weapon</li>
<li>Ammo</li>
<li>Bomb</li>
<li>StasisBomb</li>
<li>SpeedBoost</li>
<li>HealthRegenRate</li>
<li>ArtifactSlot</li>
<li>PickupSlot</li>
<li>Radar</li>
<li>Custom</li>
</ul>

<h3 id="pickupcategories">PickupCategories</h3>

<ul>
<li>Consumable</li>
<li>Instant</li>
<li>Accessory</li>
</ul>

<h3 id="artifacttypes">ArtifactTypes</h3>

<ul>
<li>Defender</li>
<li>Shield</li>
<li>Companion</li>
<li>Health</li>
<li>Decoy</li>
<li>Beacon</li>
<li>Avoid</li>
<li>Fungus</li>
<li>Bomb</li>
<li>StasisBomb</li>
<li>PacifierBomb</li>
<li>LaserMine</li>
<li>Invisibility</li>
<li>Custom</li>
</ul>

<aside class="warning">TODO: Add a lot more!</aside>

          <h1 id="entity-scripting">Entity Scripting</h1>

<h2 id="lua-callbacks">Lua callbacks</h2>

<blockquote>
<p>Set a lua callback in MobDefs.</p>
</blockquote>
<pre class="highlight plaintext"><code>Set onActivateLuaHandler                ExampleActivateLuaHandler
</code></pre>

<p>Lua can receive callbacks allowing entities to be almost entirely controlled from script. These are initialised in MobDefs.</p>

<aside class="notice">
More callbacks will be added in future.
</aside>

<h3 id="onactivateluahandler-entity">onActivateLuaHandler(entity)</h3>

<p>Perform any initialisation in onActivateLuaHandler.</p>

<p>The AI state machine has not been loaded at this point, and some of the entity specific settings
may not be ready, possibly including position, so this should be limited to setting custom data.</p>

<p>Other initialisation could be part of FixedUpdate. When entity.isStarted == false, it&rsquo;s the very first time FixedUpdate has been run.</p>

<h3 id="onfixedupdateluahandler-entity-time">onFixedUpdateLuaHandler(entity, time)</h3>

<p>Fixed updates are called very 1/60th of a second. Multiple fixed updates can occur between rendering frames.</p>

<p>Use this for game logic.</p>

<aside class="notice">
The first time FixedUpdate runs, entity.isStarted == false.
</aside>

<h3 id="onupdateluahandler-entity-time">onUpdateLuaHandler(entity, time)</h3>

<p>Updates are called between every rendering frame, after any fixed updates.</p>

<p>Use this for animation or input system functions.</p>

<aside class="warning">
Unity&rsquo;s input system refreshes between each update, not the fixed update.
</aside>

<h3 id="ondeathluahandler-entity-91-bool-nofx-93">onDeathLuaHandler(entity&#91;, bool noFX&#93;)</h3>

<p>The entity has died. The noFX flag requests no visual or audio fx.</p>

<p>This should be used for any death related actions, such as loot drops or spawning new enemies.</p>

<h3 id="ontrashluahandler-entity">onTrashLuaHandler(entity)</h3>

<p>The entity is being trashed.</p>

<p>This should be used to do any clean up required, such as releasing any particular resources or clearing any references.</p>

<h2 id="custom-properties">Custom Properties</h2>

<blockquote>
<p>Add a frequency property to an entity</p>
</blockquote>
<pre class="highlight plaintext"><code>entity.data.frequency = 5
</code></pre>

<p>Custom properties can be stored in the data property, which is a Lua table:</p>

<p><code class="prettyprint">entity.data.&lt;name&gt; = &lt;value&gt;</code></p>

<p>Accessing entity.data is a little slow so cache the data reference if using multiple times per frame:</p>

<p><code class="prettyprint">local data = entity.data</code></p>

<h2 id="references-to-other-entities">References to Other Entities</h2>

<blockquote>
<p>How to find and use an entity reference by id.</p>
</blockquote>
<pre class="highlight plaintext"><code>enemy = Entity.Find(entity.data.enemyUID)

if enemy ~= nil then
    -- Do something
else
    -- Zero the uid
    entity.data.enemyUID = 0
end
</code></pre>

<blockquote>
<p>Find an entity by name.</p>
</blockquote>
<pre class="highlight plaintext"><code>Entity.Find(entity.data.enemyName)
</code></pre>

<p>It&rsquo;s often useful to store some kind of reference to an entity. However, <strong>do not ever store an actual reference to an entity, only store the entity.uid.</strong>
Use the following functions to find the entity, and check for nil to be sure the entity still exists:</p>

<p><code class="prettyprint">Entity.Find(&lt;uid&gt;)</code></p>

<p>This can be used but is slower:</p>

<p><code class="prettyprint">Entity.Find(&lt;name&gt;)</code></p>

<p>Entities will be returned if dead, but not if trashed. Most entities trash themselves on death unless they have a death sequence or are the player.</p>

<aside class="warning">
Do not ever store a reference to an entity.
</aside>

<aside class="success">
The uid is never 0 so this can be used safely to indicate no entity.
</aside>

<h2 id="spawning-entities">Spawning Entities</h2>

<blockquote>
<p>Create a projectile from an entity which we know is a turret.</p>
</blockquote>
<pre class="highlight plaintext"><code>projectile = App.mobManager:Create(entity.ammunition)
projectile:Activate(entity.attributes, entity.position, entity.parentColony, entity.team)
projectile:SetPitch(math.PI)
</code></pre>

<p>Although there are commands to spawn entities, it&rsquo;s possible to create them using the internal functions.</p>

<p>Two steps are required: Create and Activate. Create spawns the basic entity but entity specific settings are uninitialised and should not be used.
Normally Activate will be called immediately afterwards. With the resultant entity, it&rsquo;s possible to then further customise it.</p>

<h3 id="app-mobmanager-create-type">App.mobManager.Create(type)</h3>

<p>Creates the new entity.</p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>string</td>
<td>The MobDef to create.</td>
</tr>
</tbody></table>

<p><strong>Returns:</strong> The created entity or nil if there was an error.</p>

<h3 id="entity-activate">entity.Activate(&hellip;)</h3>

<p>Creates the new entity.</p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>attributes</td>
<td>Attributes</td>
<td></td>
</tr>
<tr>
<td>position</td>
<td>Vector2</td>
<td></td>
</tr>
<tr>
<td>parentColony</td>
<td>Colony</td>
<td></td>
</tr>
<tr>
<td>team</td>
<td>Team</td>
<td></td>
</tr>
</tbody></table>

<aside class="notice">
Some entities have their own Activate method. This will be documented with the entity class documentation.
</aside>

<h2 id="world-collisions">World Collisions</h2>

<p>The collision system runs as long as the object has a velocity and the relevant <a href="#entity-physicals">collision flags</a> are set.
Entities are stopped from moving through scenery or doors but the actual reaction is entity specific. Vehicles
react by bouncing, as does the player, other items may simply stop.</p>

<p>Entities have two flags to signify collisions:</p>

<table><thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>RW</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>collidedWithScenery</td>
<td>bool</td>
<td>r</td>
<td>Collided with the level map (distance field). <strong>collidedWithSceneryInfo</strong> contains the relevant details. This is described futher below.</td>
</tr>
<tr>
<td>collidedWithDoor</td>
<td>bool</td>
<td>r</td>
<td>Collided with a door. <strong>collidedWithDoorInfo</strong> contains the Door itself.</td>
</tr>
</tbody></table>

<blockquote>
<p>Get the door direction.</p>
</blockquote>
<pre class="highlight plaintext"><code>normalisedDirection = door.ClosedSegment.Direction
</code></pre>

<blockquote>
<p>Find which side of the door an entity is.</p>
</blockquote>
<pre class="highlight plaintext"><code>if (App.doorManager:RightSide(door, entity.position)) then ...
</code></pre>

<p>If a door was collided with, it may be useful to get the door direction and to find which side of the door the entity is.
It&rsquo;s then possible to move perpendicular to the door direction (for example).</p>

<p>If it would be useful to have a few tenths of a second to deal with the collision, such as to engage in avoidance procedures, this call starts a small and somewhat randomised timer accordingly:</p>

<p><code class="prettyprint">entity.SetAvoidanceMode()</code></p>

<p>Check if in avoidance mode with:</p>

<p><code class="prettyprint">entity.isInAvoidanceMode</code></p>

<aside class="notice">
AvoidanceMode is simply a flag managed by a preset timer.
</aside>

<h2 id="world-collision-methods">World Collision Methods</h2>

<blockquote>
<p>Look ahead of the entity and get the collision information.</p>
</blockquote>
<pre class="highlight plaintext"><code>local info, reflectedPosition = Level.distanceField:CollideVector(entity.position, entity.position + moveVector)

if info ~= nil then
    -- Collision handling
end
</code></pre>

<p>It may be useful to actually run collision methods manually. The CollideVector method is accurate and uses bilinear interpolation.</p>

<p><code class="prettyprint">Level.distanceField:CollideVector(start, end, out reflectedPosition[, length])</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>start</td>
<td>Vector2</td>
<td>Start position.</td>
</tr>
<tr>
<td>end</td>
<td>Vector2</td>
<td>End position.</td>
</tr>
<tr>
<td>result</td>
<td>Vector2</td>
<td>Resulting position based on the angle of incidence.</td>
</tr>
<tr>
<td>length</td>
<td>float</td>
<td>Pass the length parameter if (end - start).magnitude is know, else it will be calculated.</td>
</tr>
</tbody></table>

<p><strong>Returns:</strong> A DistanceFieldCollisionInfo structure or nil if there was no collision.</p>

<aside class="notice">
Notice that &lsquo;reflectedPosition&rsquo; is an out parameter so is passed by an out reference. See the example.
</aside>

<h3 id="distancefieldcollisioninfo">DistanceFieldCollisionInfo</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>RW</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>intersection</td>
<td>Vector2</td>
<td>rw</td>
<td>The actual point of intersection with the solid area of the distance field.</td>
</tr>
<tr>
<td>gradientAngle</td>
<td>float</td>
<td>rw</td>
<td>The gradient angle of the intersection (radians).</td>
</tr>
<tr>
<td>reflectionAngle</td>
<td>float</td>
<td>rw</td>
<td>The angle of reflection (radians).</td>
</tr>
</tbody></table>

<h2 id="world-avoidance-methods">World Avoidance Methods</h2>

<p>Collision methods have a high processing overhead, but avoidance methods provide various ways to look into the distance field.</p>

<h3 id="distance-field-value">Distance Field Value</h3>

<p>The simplest methods get the distance field value. The distance field has a value 0-255, where 128 is the border between outside and inside the scenery.
The raw values in the field tend to be multiples of 4 and are never 128. Values of 116+ or 140- may benefit from bilinear interpolated field values, depending what the requirement is.
All raw values should be treated as very approximate but they are very fast to obtain.</p>

<p><code class="prettyprint">Level.distanceField:GetPoint(position)</code></p>

<p><code class="prettyprint">Level.distanceField:GetBilinearPoint(position)</code></p>

<h3 id="distance-field-gradient">Distance Field Gradient</h3>

<p><code class="prettyprint">Level.distanceField:GetGradient(position)</code></p>

<p><strong>Returns:</strong> The gradient as a normalized Vector2.</p>

<h3 id="getavoidancevector-start-end-avoidancearea">GetAvoidanceVector(start, end, avoidanceArea)</h3>

<table><thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>start</td>
<td>Vector2</td>
<td>Start position.</td>
</tr>
<tr>
<td>end</td>
<td>Vector2</td>
<td>End position.</td>
</tr>
<tr>
<td>avoidanceArea</td>
<td>float</td>
<td>How far from the border region needs to be avoided. This is in distance field units, so a value of 8 would consider 120 (128-8) as the start of the avoidance area.</td>
</tr>
</tbody></table>

<p><strong>Returns:</strong> A DistanceFieldAvoidanceInfo structure or nil if there was no avoidance needed.</p>

<h3 id="distancefieldavoidanceinfo">DistanceFieldAvoidanceInfo</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>RW</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>strength</td>
<td>float</td>
<td>rw</td>
<td>The strength of the avoidance needed, 0-1 (linearly interpolated).</td>
</tr>
<tr>
<td>avoidanceAngle</td>
<td>float</td>
<td>rw</td>
<td>The avoidance angle (radians).</td>
</tr>
<tr>
<td>collision</td>
<td>bool</td>
<td>rw</td>
<td>true if there was a collision with a solid area (128+).</td>
</tr>
</tbody></table>

<h2 id="world-line-of-sight-methods">World Line of Sight Methods</h2>

<p>It can be useful to test for line of sight. This accounts for raw distance field values and doors.</p>

<p>The following two functions require both points to be on the map:</p>

<p><code class="prettyprint">local result = Level.distanceField:LineOfSight(start, length, angle)</code></p>

<p><code class="prettyprint">local result = Level.distanceField:LineOfSight(start, end)</code></p>

<p><strong>Returns:</strong> true if there is line of sight.</p>

<p>The following two functions ignores if the start point is in a solid area and also clips against the map edges:</p>

<p><code class="prettyprint">local result = Level.distanceField:LineOfSightClipped(start, length, angle)</code></p>

<p><code class="prettyprint">local result = Level.distanceField:LineOfSightClipped(start, end)</code></p>

<p><strong>Returns:</strong> true if there is line of sight.</p>

<p>The following function returns the interception point, again only using raw distance field values rather than bilinear interpolation so it&rsquo;s quite approximate.</p>

<p>local result, intercept = Level.distanceField:Intercept(start, end)</p>

<p><strong>Returns:</strong> true if there is an intercept point.</p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>start</td>
<td>Vector2</td>
<td>Start position.</td>
</tr>
<tr>
<td>end</td>
<td>Vector2</td>
<td>End position.</td>
</tr>
<tr>
<td>length</td>
<td>float</td>
<td>Given with angle as an alternative to the end point.</td>
</tr>
<tr>
<td>angle</td>
<td>float</td>
<td>Angle (Radians). Given with length as an alternative to the end point.</td>
</tr>
</tbody></table>

<h2 id="animation">Animation</h2>

<p>Although there is no animation system, SpriteInstance objects can be controlled by code to do procedural or other animation.
This should be done in the onFixedUpdateLuaHandler.</p>

<p>SpriteInstances are a processed version of SpriteDefs, as defined in the SpriteDefs configuration file.
They have all the layers and elements that are enabled at that point, but they have processed the element settings into something closer to a rendering primitive.
Primitives are created at render time, however, so the instance is still in a form where it can be animated in interesting ways.</p>

<h3 id="step-1-spritedef-layers-and-elements">Step 1 - SpriteDef Layers and Elements</h3>

<blockquote>
<p>ParameciumMine example.</p>
</blockquote>
<pre class="highlight plaintext"><code>local spriteDef = entity.spriteDef

local elementUpper = spriteDef:GetIndexedLayerElement(0, 0)
local elementLower = spriteDef:GetIndexedLayerElement(0, 1)
</code></pre>

<blockquote>
<p>ParameciumMine example 2 - slower but can be a useful technique.</p>
</blockquote>
<pre class="highlight plaintext"><code>local layer = entity.spriteDef.layers[0]
local elementUpper = layer.elements[0]
local elementLower = layer.elements[1]

local radiusUpper = elementUpper.baseWidth / 2
local lengthUpper = elementUpper.baseLength

local radiusLower = elementLower.baseWidth / 2
local lengthLower = elementLower.baseLength
</code></pre>

<p>It&rsquo;s usually important to have reference to the original SpriteDef and the SpriteInstance, and get the matching layers and elements of each.</p>

<p><code class="prettyprint">local layer = entity.spriteDef:GetLayer(&quot;&lt;layer&gt;&quot;)</code></p>

<p><code class="prettyprint">local element = entity.spriteDef:GetElement(layer, &quot;&lt;element&gt;&quot;)</code></p>

<p>Or in one call:</p>

<p><code class="prettyprint">local element = entity.spriteDef:GetLayerElement(&quot;&lt;layer&gt;&quot;, &quot;&lt;element&gt;&quot;)</code></p>

<p>There is a <strong>faster</strong> approach. We can also work in the same order that the SpriteDef was defined, assuming the layer and element order and accessing them as arrays:</p>

<p><code class="prettyprint">layer = entity.spriteDef.layers[&lt;index&gt;]</code></p>

<p><code class="prettyprint">element = layer.elements[&lt;index&gt;]</code></p>

<p>Or in one call:</p>

<p><code class="prettyprint">element = entity.spriteDef:GetIndexedLayerElement(4, 0)</code></p>

<p>Changing the original SpriteDef would change it for all objects using that SpriteDef, and only if they were all told to update their SpriteInstance.</p>

<p>If the SpriteDef itself is changed, to tell all related objects to update as soon as possible, for each one:</p>

<p><code class="prettyprint">entity.spriteInstanceDirty = true</code></p>

<p>Or to update immediately:</p>

<p><code class="prettyprint">entity.ProcessSprites()</code></p>

<p>If only the current sprite needs to change and the only way to do the animation is by animating the SpriteDef:</p>

<ul>
<li>Change the SpriteDef</li>
<li>Use a custom property on the entity to track the change</li>
<li>Call entity.ProcessSprites()</li>
<li>Revert the SpriteDef to its original form</li>
</ul>

<h3 id="step-2-spritedef-layers-and-elements">Step 2 - SpriteDef Layers and Elements</h3>

<blockquote>
<p>ParameciumMine example.</p>
</blockquote>
<pre class="highlight plaintext"><code>local spriteInstance = entity.spriteInstance

local rawElementUpper = spriteInstance:GetIndexedRawLayerElement(0, 0)
local rawElementLower = spriteInstance:GetIndexedRawLayerElement(0, 1)
local rawElementLight = spriteInstance:GetIndexedRawLayerElement(1, 0)
</code></pre>

<blockquote>
<p>ParameciumMine example 2 - slower but can be a useful technique.</p>
</blockquote>
<pre class="highlight plaintext"><code>local rawLayer = entity.spriteInstance.rawLayers[0]
local rawElementUpper = rawLayer.rawElements[0]
local rawElementLower = rawLayer.rawElements[1]
local lightLayer = entity.spriteInstance.rawLayers[1]
local lightElement = lightLayer.rawElements[0]
</code></pre>

<p>In most circumstances it&rsquo;s only the SpriteDef that should be changed.
Layers and elements are accessed in a similar fashion to with SpriteDefs, but note that these a given a raw label to differentiate them.</p>

<p><code class="prettyprint">local rawLayer = entity.spriteInstance:GetRawLayer(&quot;&lt;layer&gt;&quot;)</code></p>

<p><code class="prettyprint">local rawElement = entity.spriteInstance:GetRawElement(rawLayer, &quot;&lt;element&gt;&quot;)</code></p>

<p>Or in one call:</p>

<p><code class="prettyprint">local rawElement = entity.spriteInstance:GetRawLayerElement(&quot;&lt;layer&gt;&quot;, &quot;&lt;element&gt;&quot;)</code></p>

<p>There is a faster approach. We can also work in the same order that the SpriteDef was defined, assuming the layer and element order and accessing them as arrays:</p>

<p><code class="prettyprint">rawLayer = entity.spriteInstance.rawLayers[&lt;index&gt;]</code></p>

<p><code class="prettyprint">rawElement = rawLayer.rawElements[&lt;index&gt;]</code></p>

<p>Or in one call:</p>

<p><code class="prettyprint">rawElement = entity.spriteInstance:GetIndexedRawLayerElement(&lt;index&gt;, &lt;index&gt;)</code></p>

<aside class="warning">
If any layers or elements are disabled, then the SpriteInstance will be in a different order to the SpriteDef.
</aside>

<h3 id="step-3-animate">Step 3 - Animate!</h3>

<blockquote>
<p>ParameciumMine example.</p>
</blockquote>
<pre class="highlight plaintext"><code>local data = entity.data

-- Get the current point in the animation
local animationLength = data.animationLength
local time = App.game.LevelTime + data.animationOffset
local t = time - (math.floor(time / animationLength) * animationLength)

-- Sine pulse
local minScale = 1

local scale = math.sin((t * math.pi * 2)/animationLength)
local finalScale = (minScale ) + (scale * 0.2)

rawElementUpper:SetRadius(radiusUpper * finalScale)
rawElementUpper:SetLength(lengthUpper * finalScale)
rawElementLight:SetOffset(scale)

finalScale = (minScale) + (-scale * .2)
rawElementLower:SetRadius(radiusLower * finalScale)
rawElementLower:SetLength(lengthLower * finalScale)
rawElementLight:SetRadius(radiusUpper * (1 + (math.abs(scale))))
rawElementLight:SetLength(radiusUpper * (4.5 - (0.5 * math.abs(scale))))
</code></pre>

<p>SpriteDef properties are accessed using the same names as in the SpriteDef file.</p>

<p>Changing SpriteInstance or SpriteDef&rsquo;s properties directly can be slow, particularly with Vector2 and Color, as can accessing a colour&rsquo;s individual components.
Use the Set methods where possible.</p>

<p>The following SpriteInstance properties can be changed. Note that the actual effect does depend somewhat on the actual element being rendered.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>hotspot</td>
<td>Vector2</td>
<td></td>
</tr>
<tr>
<td>radius</td>
<td>float</td>
<td></td>
</tr>
<tr>
<td>length</td>
<td>float</td>
<td></td>
</tr>
<tr>
<td>angle</td>
<td>float</td>
<td></td>
</tr>
<tr>
<td>angle2</td>
<td>float</td>
<td>Used by Nose elements.</td>
</tr>
<tr>
<td>colour1</td>
<td>Color</td>
<td></td>
</tr>
<tr>
<td>colour2</td>
<td>Color</td>
<td></td>
</tr>
<tr>
<td>offset</td>
<td>float</td>
<td></td>
</tr>
<tr>
<td>extension</td>
<td>float</td>
<td>Used by ExtendedLine elements.</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Method</th>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>SetHotspot</td>
<td>float x, float y</td>
<td></td>
</tr>
<tr>
<td>SetRadius</td>
<td>float</td>
<td></td>
</tr>
<tr>
<td>SetLength</td>
<td>float</td>
<td></td>
</tr>
<tr>
<td>SetAngle</td>
<td>float</td>
<td></td>
</tr>
<tr>
<td>SetAngle2</td>
<td>float</td>
<td></td>
</tr>
<tr>
<td>SetColour1</td>
<td>float r, float g, float b</td>
<td></td>
</tr>
<tr>
<td>SetColour2</td>
<td>float r, float g, float b</td>
<td></td>
</tr>
<tr>
<td>SetColourAlpha</td>
<td>float</td>
<td></td>
</tr>
<tr>
<td>SetOffset</td>
<td>float</td>
<td></td>
</tr>
<tr>
<td>SetExtension</td>
<td>float</td>
<td></td>
</tr>
</tbody></table>

<h3 id="step-4">Step 4</h3>

<p>If the size expands to substantially different than the original sprite, clipping will be affected. This can be rectified by calling:</p>

<p><code class="prettyprint">entity:RecalculateExtents()</code></p>

<aside class="notice">
This should only be used if clipping problems are apparent.
</aside>

<h2 id="misc-actions">Misc Actions</h2>

<h3 id="dropping-energy">Dropping Energy</h3>

<blockquote>
<p>Drop 5 units of energy in 15 energy balls within a 10 unit radius of the current entity.</p>
</blockquote>
<pre class="highlight plaintext"><code>App.terraformEnergyManager:AddEnergySpread(entity.position, 5, 15, 10.0)
</code></pre>

<p>To drop energy without relying on the regular energy drop:</p>

<p><code class="prettyprint">App.terraformEnergyManager:AddEnergySpread(position, amount, numParticles, radius[,timeOut])</code></p>

<p>For a single ball of energy:</p>

<p><code class="prettyprint">App.terraformEnergyManager:AddEnergy(position, amount[,time out])</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>position</td>
<td>Vector2</td>
<td>Location of energy drop.</td>
</tr>
<tr>
<td>amount</td>
<td>int</td>
<td>Amount of energy to drop.</td>
</tr>
<tr>
<td>numParticles</td>
<td>int</td>
<td>Number of particles to distribute energy within.</td>
</tr>
<tr>
<td>radius</td>
<td>float</td>
<td>Radius of energy drop area.</td>
</tr>
<tr>
<td>timeOut</td>
<td>float</td>
<td>How long before the energy times out. If no time out is provided, a random time will be used based on the life configs in GameDefaults:GameConfig.TerraformEnergyManager</td>
</tr>
</tbody></table>

          <h1 id="entity-reference">Entity Reference</h1>

<p>Entities are managed through a combination of internal code and external scripting,. The internal code handles core management, such as health and movement.
Scripting can be used to create custom entities, AI and animation.</p>

<h2 id="mobs-entities-and-vehicles">Mobs, Entities and Vehicles</h2>

<p>The core game objects are Mobs, managed by the MobManager, and the Entity class inherits from the Mob class.
Entities are the most common game elements that will be interacted with. The core game objects derive from Entity either directly or indirectly.</p>

<p>The Vehicle class the parent of any entity which uses the behaviour system or has more complex movement controls.</p>

<aside class="notice">
All mobs can be configured in Settings/MobDefs.cfg.
</aside>

<h2 id="mobs">Mobs</h2>

<table><thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>RW</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>string</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>uid</td>
<td>int</td>
<td>r</td>
<td>Guaranteed to be unique.</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>rw</td>
<td></td>
</tr>
<tr>
<td>autoNamed</td>
<td>bool</td>
<td>r</td>
<td>The mob was given an automatic name: &lt;type&gt;_&lt;uid&gt;.</td>
</tr>
<tr>
<td>isActive</td>
<td>bool</td>
<td>rw</td>
<td>A mob can be made temporarily inactive in which case it won&rsquo;t be updated etc.</td>
</tr>
<tr>
<td>isStarted</td>
<td>bool</td>
<td>rw</td>
<td>At least one fixed update or update has run.</td>
</tr>
<tr>
<td>isRecyclable</td>
<td>bool</td>
<td>rw</td>
<td>Mob is suitable for recycling.</td>
</tr>
<tr>
<td>isTrashed</td>
<td>bool</td>
<td>r</td>
<td>Mob has been trashed. Some mobs may be in the active mob list but no longer active or about to be trashed at the end of the frame. They should be ignored.</td>
</tr>
<tr>
<td>isRecycled</td>
<td>bool</td>
<td>r</td>
<td>Mob has been recycled.</td>
</tr>
<tr>
<td>isRenderable</td>
<td>bool</td>
<td>rw</td>
<td>Mob can be rendered.</td>
</tr>
<tr>
<td>isDebugRenderable</td>
<td>bool</td>
<td>rw</td>
<td>Mob can be debug rendered.</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Method</th>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>IsType</td>
<td>type&#91;,bool inherited&#93;</td>
<td>Test if mob is an instance of type, or inherits from a type. <strong>Returns:</strong> true if mob is an instance of type.</td>
</tr>
<tr>
<td>GetUserConfig</td>
<td>key</td>
<td>Gets a user config setting. See <a href="#entity-configs">Entity Configs</a>. <strong>Returns:</strong> Setting object or nil if key not found.</td>
</tr>
<tr>
<td>Trash</td>
<td></td>
<td>Trash a mob with no idea fx, stats etc. Don&rsquo;t use the object at all after it&rsquo;s trashed.</td>
</tr>
</tbody></table>

<aside class="warning">
Do not ever use a Trashed object. If in an update for the entity and you call its trashed method, return immediately afterwards. The isTrashed flag is set when the mob is trashed.
</aside>

<h2 id="entity-configs">Entity Configs</h2>

<blockquote>
<p>Access an entity&rsquo;s config setting.</p>
</blockquote>
<pre class="highlight plaintext"><code>local value = entity.speciesID
</code></pre>

<p>The MobDefs <a href="#configuration">Configuration</a> file is used to initialise entities. These configs can be accessed from an entity just like any other property.</p>

<aside class="notice">
These items should be considered read only.
</aside>

<h3 id="custom-config-settings">Custom Config Settings</h3>

<blockquote>
<p>Access a custom item from an entity&rsquo;s config.</p>
</blockquote>
<pre class="highlight plaintext"><code>-- In MobDefs:
--  Set frequency               120

local value = entity.userConfigs.frequency.asInt
</code></pre>

<p>Custom entries can be added to entities in MobDefs by simply adding them as any other config setting. Since they are not declared within the source code, they are added instead as a Setting to a Dictionary in the entity, called userConfigs. A Setting is a class storing custom data.</p>

<p>From lua, they can be accessed as follows:</p>

<p><code class="prettyprint">&lt;entity&gt;.userConfigs.&lt;key&gt;</code></p>

<p>It&rsquo;s also possible to use a function which returns nil if the key doesn&rsquo;t exist:</p>

<p><code class="prettyprint">setting = entity.GetUserConfig(key)</code></p>

<p>When you come to use it, you need to tell the Setting what kind of data it is. There are the following options:</p>

<ul>
<li>asInt</li>
<li>asFloat</li>
<li>asBool</li>
<li>asString</li>
<li>asVector2</li>
<li>asVector3</li>
<li>asVector4</li>
<li>asColor</li>
<li>asIntArray</li>
<li>asFloatArray</li>
<li>asStringArray</li>
</ul>

<blockquote>
<p>Print a Setting&rsquo;s path or key.</p>
</blockquote>
<pre class="highlight plaintext"><code>print(entity.userConfigs.frequency.path)
print(entity.userConfigs.frequency.key)
</code></pre>

<p>If its useful, you can also print out the full path to the setting, or just the name (key) itself, using the path or key properties.</p>

<h2 id="entity-physicals">Entity Physicals</h2>

<table><thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>RW</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>position</td>
<td>Vector2</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>lastPosition</td>
<td>Vector2</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>velocity</td>
<td>Vector2</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>rotation</td>
<td>float</td>
<td>r</td>
<td>Radians</td>
</tr>
<tr>
<td>scale</td>
<td>float</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>radius</td>
<td>float</td>
<td>r</td>
<td>Accounts for scale</td>
</tr>
<tr>
<td>pitch</td>
<td>float</td>
<td>r</td>
<td>Angle of movement and should match Velocity normally (may be entity dependent)</td>
</tr>
<tr>
<td>visiblePitch</td>
<td>float</td>
<td>r</td>
<td>Visible angle which will often match pitch and will almost always match rotation (entity dependent)</td>
</tr>
<tr>
<td>maxSpeed</td>
<td>float</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>speed</td>
<td>float</td>
<td>r</td>
<td>Vehicles only. If not available, can be calculated from from the velocity magnitude (velocity.magnitude)</td>
</tr>
<tr>
<td>fieldOfViewRadians</td>
<td>float</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>cosHalfFieldOfView</td>
<td>float</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>sceneryCollisionsEnabled</td>
<td>bool</td>
<td>rw</td>
<td></td>
</tr>
<tr>
<td>collidedWithScenery</td>
<td>bool</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>collidedWithSceneryInfo</td>
<td>DistanceFieldCollisionInfo</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>collidedWithDoor</td>
<td>bool</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>collidedWithDoorInfo</td>
<td>Door</td>
<td>r</td>
<td></td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Method</th>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>SetPosition</td>
<td>float x, float, y</td>
<td>Sets position and lastPosition to the arguments.</td>
</tr>
<tr>
<td>MovePosition</td>
<td>float x, float, y</td>
<td>Sets position, and sets lastPosition to the old position value.</td>
</tr>
<tr>
<td>SetVelocity</td>
<td>float x, float, y</td>
<td></td>
</tr>
<tr>
<td>SetPitch</td>
<td>float</td>
<td>Radians. May change rotation.</td>
</tr>
<tr>
<td>SetVisiblePitch</td>
<td>float</td>
<td>Radians. May change rotation.</td>
</tr>
<tr>
<td>SetRotation</td>
<td>float</td>
<td>Radians. Use only if Pitch and VisiblePitch cannot be used as object can&rsquo;t officially rotate</td>
</tr>
<tr>
<td>SetScale</td>
<td>float</td>
<td></td>
</tr>
<tr>
<td>SetRadius</td>
<td>float</td>
<td></td>
</tr>
<tr>
<td>SetFieldOfView</td>
<td>float</td>
<td>Degres.</td>
</tr>
<tr>
<td>IsOnScreen</td>
<td>&#91;bool retest&#93;</td>
<td>This is usually baed on rendering, so sometimes a test needs to be requested to prevent a faulty cached value being used. Note that this test is not very accurate and errs on the side of caution for clipping purposes. <strong>Returns:</strong> true if the sprite is on screen.</td>
</tr>
</tbody></table>

<h2 id="entity-attributes-and-relationships">Entity Attributes and Relationships</h2>

<blockquote>
<p>Add a frequency property to the entity in Lua</p>
</blockquote>
<pre class="highlight plaintext"><code>entity.data.frequency = 5
</code></pre>

<table><thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>RW</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>label</td>
<td>string</td>
<td>rw</td>
<td>The label is the name of the item as used in-game. A random name is created using the label generator if none is provided.</td>
</tr>
<tr>
<td>attributes</td>
<td>float energy, float strength, float speed</td>
<td>r</td>
<td>Core attributes such as speed, strength, and energy. They are not clamped but should normally be 0-1. Higher numbers can give interesting visuals and most calculations using these attributes will clamp the input to 0-1 anyway.</td>
</tr>
<tr>
<td>team</td>
<td>Team</td>
<td>r</td>
<td>Can print team.name, check team.isPlayer or check team.isGrey</td>
</tr>
<tr>
<td>teamColours</td>
<td>Color[]</td>
<td>r</td>
<td>The team colour array.</td>
</tr>
<tr>
<td>parentFlora</td>
<td>Flora</td>
<td>r</td>
<td>The parent flora, if any.</td>
</tr>
<tr>
<td>parentColony</td>
<td>Colony</td>
<td>r</td>
<td>The parent colony, if any.</td>
</tr>
<tr>
<td>aiGroup</td>
<td>AIGroup</td>
<td>r</td>
<td>The parent group, if any (for AI travelling in groups).</td>
</tr>
<tr>
<td>isAlive</td>
<td>bool</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>isDead</td>
<td>bool</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>isInStasis</td>
<td>bool</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>isPacified</td>
<td>bool</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>isThinking</td>
<td>bool</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>isPlayer</td>
<td>bool</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>isFlora</td>
<td>bool</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>isEquipment</td>
<td>bool</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>isTargetable</td>
<td>bool</td>
<td>r</td>
<td>Entity is a legitimate attack target.</td>
</tr>
<tr>
<td>isDamageable</td>
<td>bool</td>
<td>r</td>
<td>Entity can be damaged it attacked.</td>
</tr>
<tr>
<td>data</td>
<td>bool</td>
<td>r</td>
<td>Lua can use the data property to store additional properties. This can be any Lua datatype. <strong>This is automatically cleared when the mob is trashed.</strong></td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Method</th>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>SetAttributes</td>
<td>Attributes</td>
<td></td>
</tr>
<tr>
<td>UpdateCharacteristics</td>
<td></td>
<td>Updates any characteristics which depend on attributes.</td>
</tr>
<tr>
<td>SetTeam</td>
<td>Team</td>
<td></td>
</tr>
<tr>
<td>SetTeam</td>
<td>team name</td>
<td></td>
</tr>
<tr>
<td>SetParentColony</td>
<td>Colony</td>
<td></td>
</tr>
<tr>
<td>SetParentFlora</td>
<td>Flora</td>
<td></td>
</tr>
<tr>
<td>SetAIGroup</td>
<td>AIGroup</td>
<td></td>
</tr>
<tr>
<td>PowerRule</td>
<td>float attribute, Vector2 minMax, float rule</td>
<td>Static function which calculates a characteristic based on a power rule. c = min + (max - min) * pow(attr, rule). The attribute is clamped 0-1. <strong>Returns:</strong> float result</td>
</tr>
</tbody></table>

<h2 id="entity-visuals">Entity Visuals</h2>

<p>Entities are normally rendered using sprites.
A <strong>SpriteDef</strong> is the original definition and a <strong>SpriteInstance</strong> is a processed version of the SpriteDef.
and is what is actually rendered on screen. Animation works through procedural modification of the SpriteInstance.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>RW</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>spriteDef</td>
<td>SpriteDef</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>spriteInstance</td>
<td>SpriteInstance</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>spriteInstanceDirty</td>
<td>bool</td>
<td>w</td>
<td>Set to true if the sprite has been changed and the sprite instance needs processing.</td>
</tr>
<tr>
<td>alphaTransparency</td>
<td>float</td>
<td>rw</td>
<td>Set the sprite alpha. This is multiplied on top of the sprite colour.</td>
</tr>
<tr>
<td>boundingRegionDirty</td>
<td>bool</td>
<td>w</td>
<td>Set to true if something about the sprite size has changed manually, i.e. not using a regular function since these do this already.</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Method</th>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>SetSpriteDef</td>
<td>sprite name</td>
<td>Switches to using a new SpriteDef and immediately processes the SpriteInstance.</td>
</tr>
<tr>
<td>ProcessSprites</td>
<td></td>
<td>Rarely, it may be required to reprocess an entity&rsquo;s sprites manually but this shouldn&rsquo;t be used unless it specifically solves a problem.</td>
</tr>
<tr>
<td>AddOverlay</td>
<td>sprite name, int layerModifier</td>
<td>Overlay a sprite, using the layer modifier to have it go in front or beind the main sprite. Multiple overlays can be used.</td>
</tr>
<tr>
<td>RemoveOverlay</td>
<td>sprite name</td>
<td></td>
</tr>
<tr>
<td>RemoveOverlay</td>
<td>Overlay</td>
<td></td>
</tr>
</tbody></table>

<h3 id="overlays">Overlays</h3>

<p>Overlay is a simple class which manages entity overlays.
In Lua this is tagged Entity_Overlay since it&rsquo;s a subclass of Entity.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>RW</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>string</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>spriteDef</td>
<td>SpriteDef</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>spriteInstance</td>
<td>SpriteInstance</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>layerModifier</td>
<td>int</td>
<td>r</td>
<td></td>
</tr>
</tbody></table>

<h2 id="entity-health-and-damage">Entity Health and Damage</h2>

<table><thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>RW</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>health</td>
<td>float</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>maxHealth</td>
<td>float</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>healthRatio</td>
<td>float</td>
<td>r</td>
<td>This is simply health / maxHealth</td>
</tr>
<tr>
<td>wasAttacked</td>
<td>bool</td>
<td>r</td>
<td>true if attacked since the last fixed update.</td>
</tr>
<tr>
<td>wasAttackedBy</td>
<td>Entity</td>
<td>r</td>
<td>The attacker if attacked since the last fixed update.</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Method</th>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ModifyHealth</td>
<td>amount&#91;, bool fx&#93;</td>
<td>Increase or reduce health, with or without a visual effect if increasing health. The entity will die if health reaches zero. <strong>Returns:</strong> true if died</td>
</tr>
<tr>
<td>SetHealth</td>
<td>value</td>
<td>Set the health to a precise value</td>
</tr>
<tr>
<td>Heal</td>
<td></td>
<td>Fully heal entity</td>
</tr>
<tr>
<td>Explode</td>
<td></td>
<td></td>
</tr>
<tr>
<td>ExplodeStasis</td>
<td>float time</td>
<td>Explodes and puts area it affects into stasis</td>
</tr>
<tr>
<td>ExplodePacifier</td>
<td>float time, float ratio</td>
<td>Explodes and pacifies area such that entities attack is affected by ratio.</td>
</tr>
<tr>
<td>DieQuietly</td>
<td></td>
<td>Die without any fx.</td>
</tr>
<tr>
<td>Die</td>
<td>&#91;bool noFX&#93;</td>
<td>If true is passed, there will be no visual or audio effect associated with the death.</td>
</tr>
</tbody></table>

<h2 id="entity-attacks">Entity Attacks</h2>

<table><thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>RW</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>attackRange</td>
<td>float</td>
<td>rw</td>
<td></td>
</tr>
<tr>
<td>timeBeforeAttack</td>
<td>float</td>
<td>rw</td>
<td></td>
</tr>
<tr>
<td>attackDamage</td>
<td>float</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>attackFieldOfViewRadians</td>
<td>float</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>cosHalfAttackFieldOfView</td>
<td>float</td>
<td>r</td>
<td></td>
</tr>
<tr>
<td>targetEntity</td>
<td>Entity</td>
<td>r</td>
<td>Some entities have a target used for movement or attacking.</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Method</th>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>SetAttackFiendOfView</td>
<td>float</td>
<td>Degrees.</td>
</tr>
</tbody></table>

<aside class="warning">
The attack support functions need some minor reworking to make suitable for Lua.
</aside>

<h2 id="entity-sound-fx">Entity Sound FX</h2>

<table><thead>
<tr>
<th>Method</th>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>PlaySfx</td>
<td>sfx name&#91;,float volume, float pan&#93;</td>
<td>Play sound with volume (0-1) and pan (0-1).</td>
</tr>
<tr>
<td>PlayPositionalSfx</td>
<td>sfx name</td>
<td>Play sound and set volume and pan automatically.</td>
</tr>
</tbody></table>

<aside class="warning">
The audio API will be updated to deal with looping sounds.
</aside>

<h2 id="vehicles">Vehicles</h2>

<p>The main additions to Vehicles are improved movement configuration and code, and the support for the behaviour system.
Behaviours allow targets, flocking, and flowfields to be used as inputs to aid in deciding where to move towards.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>RW</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>speed</td>
<td>float</td>
<td>r</td>
<td>The current speed.</td>
</tr>
<tr>
<td>behavioursEnabled</td>
<td>bool</td>
<td>rw</td>
<td>Toggle to enable or disable behaviours.</td>
</tr>
<tr>
<td>isInAvoidanceMode</td>
<td>bool</td>
<td>r</td>
<td>true if a vehicle is trying to avoid scenery or a door, i.e. when there was a collision within the recent past (approx 0.35-0.65s). It&rsquo;s intended to allow ai code to have a chance to get away from the problem.</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Method</th>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>SetBehaviour</td>
<td>Behaviour</td>
<td></td>
</tr>
<tr>
<td>SetTargetBehaviour</td>
<td>Behaviour</td>
<td></td>
</tr>
<tr>
<td>SetAvoidanceMode</td>
<td></td>
<td>Puts the vehicle into avoidance mode. Internally this actually just sets a timer and relevant flag.</td>
</tr>
</tbody></table>

          <h1 id="todo">TODO</h1>

<p>Split documentation into:</p>

<ul>
<li>Modding Guide</li>
<li>Scripting Guide</li>
<li>Modding Reference</li>
<li>Scripting Reference</li>
</ul>

<p>Ensure these elements are covered:</p>

<ul>
<li>Overview of modding</li>
<li>File guide</li>
<li>Console and commands</li>
<li>Behaviours</li>
<li>State machines</li>
<li>Sprites</li>
<li>Doors</li>
<li>Explosions</li>
<li>Energy</li>
<li>FX</li>
<li>Audio</li>
<li>Locale</li>
<li>Artifacts</li>
<li>Pickups</li>
<li>Keys</li>
<li>Inventory</li>
<li>All configuration options</li>
<li>All classes that are meaningful within the game</li>
</ul>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="lua">Lua</a>
          </div>
      </div>
    </div>
  </body>
</html>
